{"version":3,"file":"bundle.cjs.js","sources":["../src/core/index.ts","../src/core/sectionRange.ts"],"sourcesContent":["import type { DeafultConfig } from '../types'\n\n/**\n * 构建正则\n * @param keywords\n */\nexport function createRegexFromKeywords(keywords: string | string[]): RegExp | undefined {\n  if (typeof keywords === 'string') {\n    return new RegExp(`\\\\b${keywords}\\\\b`, 'gi')\n  }\n  if (Array.isArray(keywords)) {\n    // 将所有关键字用 | 分隔，并加入 \\b 以确保匹配整个单词，关键字先进行转义\n    return new RegExp(`\\\\b(${keywords.join('|')})\\\\b`, 'gi')\n  }\n}\n\nexport function matchKeywordsWithPositions(str: string, keywords: string | string[]) {\n  const regex = createRegexFromKeywords(keywords)\n  const matches = []\n  let match: RegExpExecArray | null\n\n  // 使用 exec 遍历所有匹配项\n  // eslint-disable-next-line no-cond-assign\n  while ((match = (regex as RegExp).exec(str)) !== null) {\n    matches.push({\n      keyword: match[0],\n      start: match.index,\n      end: match.index + match[0].length,\n    })\n  }\n\n  return matches\n}\n\n/**\n * 核心方法\n * @param config\n */\nexport function textHighlight(config: DeafultConfig) {\n  const { text, keywords } = config\n  return matchKeywordsWithPositions(text, keywords)\n}\n","export default (container: Node, positions: { start: number, end: number }[]) => {\n  // Selection 对象表示用户选择的文本范围或插入符号的当前位置。它代表页面中的文本选区，可能横跨多个元素。通常由用户拖拽鼠标经过文字而产生\n  const selection = document?.getSelection()\n  if (!selection) {\n    throw new Error('No selection found')\n  }\n\n  selection.removeAllRanges()\n  positions.forEach(({ start, end }) => {\n    const range = document.createRange()\n    range.setStart((container as any).firstChild, start)\n    range.setEnd((container as any).firstChild, end)\n    selection.addRange(range)\n  })\n}\n"],"names":["matchKeywordsWithPositions","str","keywords","match","regex","RegExp","concat","Array","isArray","join","createRegexFromKeywords","matches","exec","push","keyword","start","index","end","length","container","positions","selection","document","getSelection","Error","removeAllRanges","forEach","_a","range","createRange","setStart","firstChild","setEnd","addRange","config","text"],"mappings":"aAgBgB,SAAAA,EAA2BC,EAAaC,GAOtD,IANA,IAEIC,EAFEC,EAXF,SAAkCF,GACtC,MAAwB,iBAAbA,EACF,IAAIG,OAAO,MAAAC,OAAMJ,EAAa,OAAE,MAErCK,MAAMC,QAAQN,GAET,IAAIG,OAAO,OAAAC,OAAOJ,EAASO,KAAK,KAAI,QAAQ,WAFrD,CAIF,CAGgBC,CAAwBR,GAChCS,EAAU,GAKiC,QAAzCR,EAASC,EAAiBQ,KAAKX,KACrCU,EAAQE,KAAK,CACXC,QAASX,EAAM,GACfY,MAAOZ,EAAMa,MACbC,IAAKd,EAAMa,MAAQb,EAAM,GAAGe,SAIhC,OAAOP,CACT,sBChCe,SAACQ,EAAiBC,GAE/B,IAAMC,EAAY,OAAAC,mBAAAA,gBAAAA,SAAUC,eAC5B,IAAKF,EACH,MAAM,IAAIG,MAAM,sBAGlBH,EAAUI,kBACVL,EAAUM,SAAQ,SAACC,OAAEZ,EAAKY,EAAAZ,MAAEE,EAAGU,EAAAV,IACvBW,EAAQN,SAASO,cACvBD,EAAME,SAAUX,EAAkBY,WAAYhB,GAC9Ca,EAAMI,OAAQb,EAAkBY,WAAYd,GAC5CI,EAAUY,SAASL,EACrB,GACD,wBDwBK,SAAwBM,GAE5B,OAAOlC,EADoBkC,EAAMC,KAAND,EAAMhC,SAEnC"}