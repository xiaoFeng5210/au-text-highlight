"use strict";var t=function(e,o){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])},t(e,o)};"function"==typeof SuppressedError&&SuppressedError;var e=0;function o(t,e){for(var o,n=function(t){var e=function(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")};if("string"==typeof t)return new RegExp("".concat(e(t)),"gi");if(Array.isArray(t)){var o=t.map(e);return new RegExp("(".concat(o.join("|"),")"),"gi")}}(e),i=[];null!==(o=n.exec(t));)i.push({keyword:o[0],start:o.index,end:o.index+o[0].length});return i}var n=function(e){function o(t,o){return void 0===o&&(o={}),e.call(this,t,o)||this}return function(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}(o,e),o}(function(){function t(t,e){var o;void 0===e&&(e={}),this.popoverEle=null,this.distance=5,this.distance=null!==(o=null==e?void 0:e.distance)&&void 0!==o?o:this.distance,this.init(t),this.initEvent()}return t.prototype.init=function(t){var e=document.getElementById(t);if(!e)throw new Error("popoverId is not found");this.popoverEle=e,this.popoverEle.style.visibility="hidden",this.popoverEle.style.display="none",this.popoverEle.style.position="fixed",document.body.appendChild(this.popoverEle)},t.prototype.initEvent=function(){var t=this;document.addEventListener("mouseup",(function(){setTimeout((function(){var e=t.getTriggerPosition();e?t.show(e):t.hide()}),100)}))},t.prototype.show=function(t){var e=t.x,o=void 0===e?0:e,n=t.y,i=void 0===n?0:n,r=t.width,s=void 0===r?0:r;if(this.popoverEle){var l=o+s/2-this.popoverEle.offsetWidth/2,c=i-this.popoverEle.offsetHeight-this.distance;t.height>30&&(l=o+s-this.popoverEle.offsetWidth),this.popoverEle.style.left="".concat(l,"px"),this.popoverEle.style.top="".concat(c,"px"),this.popoverEle.style.display="block",this.popoverEle.style.visibility="visible"}},t.prototype.hide=function(){this.popoverEle&&(this.popoverEle.style.display="none",this.popoverEle.style.visibility="hidden")},t.prototype.getTriggerPosition=function(){var t,e=document.getSelection();if(e){var o=null===(t=document.getSelection())||void 0===t?void 0:t.toString();if(o){var n=e.getRangeAt(0).getBoundingClientRect();return 0===n.width&&0===n.height?null:{text:o,x:n.left+window.scrollX,y:n.top+window.scrollY,width:n.width,height:n.height}}return null}console.error("no selection")},t}());exports.DrawWordConstituencyPopover=n,exports.auExtractText=function(t){return o(t.text,t.keywords)},exports.getSelectionRange=function(t,o){e=0;var n=document.getSelection(),i=n.getRangeAt(0);!function(t,o,n){var i=1e3,r=[],s=t.childNodes,l=function(t,e){if(void 0===e&&(e=0),e>i)throw new Error("DOM tree is too deep");for(var o=0;o<t.length;o++){var n=t[o];n.textContent&&("#text"===n.nodeName?r.push(n):l(n.childNodes,e+1))}};l(s),r.length>0&&r.some((function(t){return t.textContent===o.textContent?(e+=n,!0):(t.textContent&&(e+=t.textContent.length),!1)}))}(t,i.startContainer,i.startOffset);var r=e+n.toString().trim().length;return[e,r]},exports.getSelectionRangeContent=function(){if(document){var t=null===document||void 0===document?void 0:document.getSelection();if(t)return{content:t.toString(),section:t};throw new Error("selection is undefined")}throw new Error("document is undefined")},exports.sectionRangeHighlight=function(t,e){var o=null===document||void 0===document?void 0:document.getSelection();if(!o)throw new Error("No selection found");o.removeAllRanges(),e.forEach((function(e){var n=e.start,i=e.end,r=function(t,e,o){void 0===e&&(e=0);void 0===o&&(o=0);var n=[],i=function(t){(function(t,e,o){if(o||2===arguments.length)for(var n,i=0,r=e.length;i<r;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))})([],t,!0).forEach((function(t){"#text"===t.nodeName?n.push(t):t.textContent&&i(t.childNodes)}))};i(t.childNodes);var r=null,s=0,l=null,c=0,u=s;if(n.forEach((function(t){if(!r||!l){var n=t.textContent.length,i=[u,u+n];!r&&e>=i[0]&&e<i[1]&&(r=t,s=e-i[0]),!l&&o>i[0]&&o<=i[1]&&(l=t,c=o-i[0]),u+=n}})),!r||!l)return null;return[r,s,l,c]}(t,n,i),s=r[0],l=r[1],c=r[2],u=r[3],p=document.createRange();p.setStart(s,l),p.setEnd(c,u),o.addRange(p)}))};
//# sourceMappingURL=bundle.cjs.js.map
